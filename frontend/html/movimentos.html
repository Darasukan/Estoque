<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Movimenta√ß√µes - Almoxarifado</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
  <link rel="stylesheet" href="../styles.css">
</head>
<body>
  <div id="navbarContainer"></div>

  <div class="container">
    <main class="main-content">
      <h1 class="pagina-titulo">üì• Movimenta√ß√µes</h1>

      <div id="mensagem" class="mensagem"></div>

      <div class="tab-container">
        <button class="tab-btn tab-entrada ativo" data-tab="entrada">üì• Nova Entrada</button>
        <button class="tab-btn tab-saida" data-tab="saida">üì§ Nova Sa√≠da</button>
        <button class="tab-btn" data-tab="historico">üìã Hist√≥rico</button>
      </div>

      <!-- ================== ABA ENTRADA ================== -->
      <div id="tab-entrada" class="tab-content ativo">
        <div class="painel entrada">
          <h2><i class="bi bi-box-arrow-in-down"></i> Registrar Entrada</h2>

          <div class="info-box">
            <i class="bi bi-info-circle"></i> Registre o recebimento de materiais no almoxarifado.
          </div>

          <form id="formEntrada">
            <!-- Linha 1: ID, Categoria, Subcategoria -->
            <div class="form-row-tres">
              <div class="form-grupo">
                <label for="idEntrada">ID <span class="opcional">(auto)</span></label>
                <input type="text" id="idEntrada" placeholder="Autom√°tico" tabindex="-1">
              </div>
              <div class="form-grupo">
                <label for="categoriaEntrada">Categoria *</label>
                <select id="categoriaEntrada" required>
                  <option value="">Selecione</option>
                </select>
              </div>
              <div class="form-grupo">
                <label for="subcategoriaEntrada">Subcategoria *</label>
                <select id="subcategoriaEntrada" required disabled>
                  <option value="">Selecione categoria</option>
                </select>
              </div>
            </div>

            <!-- Filtro de Atributos (aparece ap√≥s selecionar subcategoria) -->
            <div id="filtroAtributosEntrada" class="filtro-atributos-mov" style="display: none;">
              <div class="filtro-atributos-header">
                <h4><i class="bi bi-funnel"></i> Filtrar por Atributos</h4>
                <button type="button" class="btn-limpar-filtros" id="btnLimparFiltrosEntrada">
                  <i class="bi bi-x-circle"></i> Limpar
                </button>
              </div>
              <div id="listaFiltrosEntrada" class="filtro-atributos-grid">
                <!-- Preenchido via JS -->
              </div>
              <div class="filtro-resultado-mov">
                <span id="contadorItensEntrada">0 itens encontrados</span>
              </div>
            </div>

            <!-- Sele√ß√£o do Item -->
            <div class="form-grupo form-grupo-item-full">
              <label for="itemEntrada">Item *</label>
              <select id="itemEntrada" required disabled>
                <option value="">Primeiro selecione categoria e subcategoria</option>
              </select>
            </div>

            <!-- Info do item selecionado -->
            <div id="itemSelecionadoEntrada" class="item-selecionado" style="display: none;">
              <div class="item-info-header">
                <i class="bi bi-pin-angle-fill"></i>
                <span class="nome" id="nomeItemEntrada">-</span>
              </div>
              <div class="detalhes">
                <div class="detalhe"><i class="bi bi-box"></i> Estoque: <strong id="estoqueItemEntrada">0</strong></div>
                <div class="detalhe"><i class="bi bi-rulers"></i> Unidade: <strong id="unidadeItemEntrada">UN</strong></div>
                <div class="detalhe"><i class="bi bi-exclamation-triangle"></i> M√≠nimo: <strong id="minimoItemEntrada">10</strong></div>
              </div>
            </div>

            <!-- Linha 2: Quantidade, Data -->
            <div class="form-row">
              <div class="form-grupo">
                <label for="qtdEntrada">Quantidade *</label>
                <input type="number" id="qtdEntrada" required min="1" placeholder="0">
              </div>
              <div class="form-grupo">
                <label for="dataEntrada">Data *</label>
                <input type="date" id="dataEntrada" required>
              </div>
            </div>

            <!-- Linha 3: Valor unit√°rio, Nota Fiscal, Fornecedor, Operador -->
            <div class="form-row-quatro">
              <div class="form-grupo">
                <label for="valorUnitarioEntrada">Valor Unit√°rio <span class="opcional">(opc)</span></label>
                <input type="text" id="valorUnitarioEntrada" placeholder="R$ 0,00">
              </div>
              <div class="form-grupo">
                <label for="nfEntrada">Nota Fiscal <span class="opcional">(opc)</span></label>
                <input type="text" id="nfEntrada" placeholder="N¬∫ NF">
              </div>
              <div class="form-grupo">
                <label for="fornecedorEntrada">Fornecedor <span class="opcional">(opc)</span></label>
                <input type="text" id="fornecedorEntrada" placeholder="Nome do fornecedor">
              </div>
              <div class="form-grupo">
                <label for="operadorEntrada">Operador *</label>
                <input type="text" id="operadorEntrada" required placeholder="Quem registrou">
              </div>
            </div>

            <div class="btn-group">
              <button type="submit" class="btn btn-entrada"><i class="bi bi-check-lg"></i> Registrar Entrada</button>
              <button type="reset" class="btn btn-secondary"><i class="bi bi-arrow-clockwise"></i> Limpar</button>
            </div>
          </form>
        </div>
      </div>

      <!-- ================== ABA SA√çDA ================== -->
      <div id="tab-saida" class="tab-content">
        <div class="painel saida">
          <h2><i class="bi bi-box-arrow-up"></i> Registrar Sa√≠da</h2>

          <div class="info-box">
            <i class="bi bi-info-circle"></i> Registre a retirada de materiais do almoxarifado.
          </div>

          <form id="formSaida">
            <!-- Linha 1: ID, Categoria, Subcategoria -->
            <div class="form-row-tres">
              <div class="form-grupo">
                <label for="idSaida">ID <span class="opcional">(auto)</span></label>
                <input type="text" id="idSaida" placeholder="Autom√°tico" tabindex="-1">
              </div>
              <div class="form-grupo">
                <label for="categoriaSaida">Categoria *</label>
                <select id="categoriaSaida" required>
                  <option value="">Selecione</option>
                </select>
              </div>
              <div class="form-grupo">
                <label for="subcategoriaSaida">Subcategoria *</label>
                <select id="subcategoriaSaida" required disabled>
                  <option value="">Selecione categoria</option>
                </select>
              </div>
            </div>

            <!-- Filtro de Atributos (aparece ap√≥s selecionar subcategoria) -->
            <div id="filtroAtributosSaida" class="filtro-atributos-mov" style="display: none;">
              <div class="filtro-atributos-header">
                <h4><i class="bi bi-funnel"></i> Filtrar por Atributos</h4>
                <button type="button" class="btn-limpar-filtros" id="btnLimparFiltrosSaida">
                  <i class="bi bi-x-circle"></i> Limpar
                </button>
              </div>
              <div id="listaFiltrosSaida" class="filtro-atributos-grid">
                <!-- Preenchido via JS -->
              </div>
              <div class="filtro-resultado-mov">
                <span id="contadorItensSaida">0 itens encontrados</span>
              </div>
            </div>

            <!-- Sele√ß√£o do Item -->
            <div class="form-grupo form-grupo-item-full">
              <label for="itemSaida">Item *</label>
              <select id="itemSaida" required disabled>
                <option value="">Primeiro selecione categoria e subcategoria</option>
              </select>
            </div>

            <!-- Info do item selecionado -->
            <div id="itemSelecionadoSaida" class="item-selecionado" style="display: none;">
              <div class="item-info-header">
                <i class="bi bi-pin-angle-fill"></i>
                <span class="nome" id="nomeItemSaida">-</span>
              </div>
              <div class="detalhes">
                <div class="detalhe"><i class="bi bi-box"></i> Estoque: <strong id="estoqueItemSaida">0</strong></div>
                <div class="detalhe"><i class="bi bi-rulers"></i> Unidade: <strong id="unidadeItemSaida">UN</strong></div>
              </div>
            </div>

            <!-- Linha 2: Quantidade, Data -->
            <div class="form-row">
              <div class="form-grupo">
                <label for="qtdSaida">Quantidade *</label>
                <input type="number" id="qtdSaida" required min="1" placeholder="0">
              </div>
              <div class="form-grupo">
                <label for="dataSaida">Data *</label>
                <input type="date" id="dataSaida" required>
              </div>
            </div>

            <!-- Linha 3: Quem Retirou, Local de Aplica√ß√£o, Operador -->
            <div class="form-row-tres">
              <div class="form-grupo">
                <label for="quemRetirouSaida">Quem Retirou *</label>
                <input type="text" id="quemRetirouSaida" required placeholder="Nome de quem retirou">
              </div>
              <div class="form-grupo">
                <label for="localAplicacaoSaida">Local de Aplica√ß√£o <span class="opcional">(opc)</span></label>
                <input type="text" id="localAplicacaoSaida" placeholder="Onde ser√° usado">
              </div>
              <div class="form-grupo">
                <label for="operadorSaida">Operador *</label>
                <input type="text" id="operadorSaida" required placeholder="Quem registrou">
              </div>
            </div>

            <!-- Observa√ß√µes -->
            <div class="form-grupo">
              <label for="obsSaida">Observa√ß√µes <span class="opcional">(opc)</span></label>
              <textarea id="obsSaida" rows="2" placeholder="Observa√ß√µes adicionais..."></textarea>
            </div>

            <div class="btn-group">
              <button type="submit" class="btn btn-saida"><i class="bi bi-check-lg"></i> Registrar Sa√≠da</button>
              <button type="reset" class="btn btn-secondary"><i class="bi bi-arrow-clockwise"></i> Limpar</button>
            </div>
          </form>
        </div>
      </div>

      <!-- ================== ABA HIST√ìRICO ================== -->
      <div id="tab-historico" class="tab-content">
        <!-- Layout com Sidebar igual ao Cat√°logo -->
        <div class="historico-layout">
          <!-- Sidebar de Filtros -->
          <aside class="historico-sidebar">
            <div class="sidebar-header">
              <h3><i class="bi bi-funnel"></i> Filtros</h3>
              <button type="button" class="btn-limpar-filtros" id="btnLimparFiltrosHist">
                <i class="bi bi-x-circle"></i> Limpar
              </button>
            </div>

            <!-- Busca -->
            <div class="filtro-grupo">
              <label for="filtroBuscaHist"><i class="bi bi-search"></i> Busca</label>
              <input type="text" id="filtroBuscaHist" placeholder="ID, item, operador...">
              <small class="filtro-hint">Busca em todos os campos</small>
            </div>

            <!-- Tipo -->
            <div class="filtro-grupo">
              <label for="filtroTipo"><i class="bi bi-arrow-left-right"></i> Tipo</label>
              <select id="filtroTipo">
                <option value="">Todos</option>
                <option value="entrada">üì• Entradas</option>
                <option value="saida">üì§ Sa√≠das</option>
              </select>
            </div>

            <!-- Categoria -->
            <div class="filtro-grupo">
              <label for="filtroCategoriaHist"><i class="bi bi-folder"></i> Categoria</label>
              <select id="filtroCategoriaHist">
                <option value="">Todas</option>
              </select>
            </div>

            <!-- Subcategoria -->
            <div class="filtro-grupo">
              <label for="filtroSubcategoriaHist"><i class="bi bi-folder2"></i> Subcategoria</label>
              <select id="filtroSubcategoriaHist" disabled>
                <option value="">Todas</option>
              </select>
            </div>

            <!-- Atributos (din√¢mico baseado na subcategoria) -->
            <div class="filtro-grupo" id="filtroAtributosContainerHist" style="display: none;">
              <label><i class="bi bi-tags"></i> Atributos</label>
              <div id="filtroAtributosHist" class="filtro-atributos">
                <!-- Preenchido via JS -->
              </div>
            </div>

            <!-- Intervalo de Datas -->
            <div class="filtro-grupo">
              <label><i class="bi bi-calendar-range"></i> Per√≠odo</label>
              <div class="filtro-datas">
                <input type="date" id="filtroDataInicio" title="Data inicial">
                <span class="filtro-datas-separador">at√©</span>
                <input type="date" id="filtroDataFim" title="Data final">
              </div>
              <small class="filtro-hint">Deixe vazio para ver todos</small>
            </div>

            <!-- Exibi√ß√£o -->
            <div class="filtro-grupo">
              <label><i class="bi bi-eye"></i> Exibi√ß√£o</label>
              <div class="filtro-checkboxes">
                <label class="checkbox-label">
                  <input type="checkbox" id="mostrarIdMov" checked>
                  <span>Mostrar ID Mov.</span>
                </label>
                <label class="checkbox-label">
                  <input type="checkbox" id="mostrarIdItem" checked>
                  <span>Mostrar ID Item</span>
                </label>
              </div>
            </div>

            <!-- Contador -->
            <div class="filtro-resultado">
              <span id="contadorMovimentacoes">0 movimenta√ß√µes</span>
            </div>
          </aside>

          <!-- √Årea Principal -->
          <div class="historico-content">
            <div class="tabela-container">
              <table id="tabelaHistorico">
                <thead>
                  <tr>
                    <th>Data</th>
                    <th class="col-id-mov">ID Mov.</th>
                    <th class="col-id-item">ID Item</th>
                    <th>Tipo</th>
                    <th>Categoria</th>
                    <th>Item</th>
                    <th>Obs</th>
                    <th>Qtd</th>
                    <th>Operador</th>
                    <th>Fornecedor</th>
                    <th>NF</th>
                    <th>Retirado Por</th>
                    <th id="colAcoes" style="display: none;">A√ß√µes</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td colspan="13" class="vazio">Nenhuma movimenta√ß√£o registrada</td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
      </div>
    </main>
  </div>

  <script src="../js/sidebar.js"></script>
  <script src="../js/movimentos.js"></script>
</body>
</html>
