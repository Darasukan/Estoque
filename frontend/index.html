<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Sistema de Estoque e Fluxo</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <div class="container">
    <!-- Sidebar de Navega√ß√£o -->
    <aside class="sidebar">
      <h1>üì¶ Estoque</h1>
      <div class="user-info">
        <p>üë§ <span id="usuarioLogado">Usu√°rio</span></p>
      </div>
      <nav>
        <a href="inventario.html" class="nav-btn" style="text-decoration: none; display: block; text-align: left;">
          üìä Invent√°rio
        </a>
        <button class="nav-btn" data-section="movimentos">
          üîÑ Movimenta√ß√µes
        </button>
        <a href="cadastro.html" class="nav-btn" style="text-decoration: none; display: block; text-align: left;">
          üìù Cadastro de Produtos
        </a>
        <button class="nav-btn" data-section="relatorios">
          üìà Relat√≥rios
        </button>
      </nav>
      <button class="btn-logout" onclick="logout()">üö™ Sair</button>
    </aside>

    <!-- Conte√∫do Principal -->
    <main class="main-content">
      <!-- Se√ß√£o de Produtos -->
      <section id="produtos" class="section active">
        <h2>Gerenciar Produtos</h2>
        
        <div class="form-section">
          <h3>Adicionar Novo Produto</h3>
          <form id="formProduto">
            <div class="form-row">
              <div class="form-group">
                <label>Nome *</label>
                <input type="text" id="nomeProduto" required placeholder="Nome do produto">
              </div>
              <div class="form-group">
                <label>SKU *</label>
                <input type="text" id="skuProduto" required placeholder="SKU √∫nico">
              </div>
            </div>
            <div class="form-row">
              <div class="form-group">
                <label>Quantidade *</label>
                <input type="number" id="qtdProduto" required min="0" placeholder="0">
              </div>
              <div class="form-group">
                <label>Pre√ßo</label>
                <input type="number" id="precoProduto" step="0.01" placeholder="0.00">
              </div>
            <div class="form-row">
              <div class="form-group">
                <label>Categoria</label>
                <input type="text" id="categoriaProduto" placeholder="Ex: Eletr√¥nicos">
              </div>
              <div class="form-group">
                <label>Fam√≠lia (Grupo)</label>
                <input type="text" id="grupoProduto" placeholder="Ex: Inform√°tica">
              </div>
            </div>

            <!-- Se√ß√£o de Atributos Din√¢micos -->
            <div id="secaoAtributos">
              <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                <strong>Atributos do Produto</strong>
                <button type="button" class="btn btn-small btn-secondary" onclick="adicionarCampoAtributo()" title="Adicionar atributo">‚ûï</button>
              </div>
              <div id="listaAtributos"></div>
              <small style="color: #666;">Adicione atributos como processador, cor, tamanho, etc.</small>
            </div>

            <button type="submit" class="btn btn-primary">‚ûï Adicionar Produto</button>
          </form>
        </div>

        <!-- Lista de Produtos -->
        <div class="table-section">
          <h3>Produtos Cadastrados</h3>
          <table id="tabelaProdutos">
            <thead>
              <tr>
                <th>ID</th>
                <th>Nome</th>
                <th>SKU</th>
                <th>Quantidade</th>
                <th>Pre√ßo</th>
                <th>Categoria</th>
                <th>A√ß√µes</th>
              </tr>
            </thead>
            <tbody id="bodyProdutos">
              <tr>
                <td colspan="7" style="text-align: center;">Nenhum produto cadastrado</td>
              </tr>
            </tbody>
          </table>
        </div>
      </section>

      <!-- Se√ß√£o de Movimenta√ß√µes -->
      <section id="movimentos" class="section">
        <h2>Registrar Movimenta√ß√µes</h2>

        <div class="form-section">
          <h3>Nova Movimenta√ß√£o</h3>
          <form id="formMovimento">
            <div class="form-row">
              <div class="form-group">
                <label>Produto *</label>
                <select id="produtoMovimento" required>
                  <option value="">-- Selecione um produto --</option>
                </select>
              </div>
              <div class="form-group">
                <label>Tipo *</label>
                <select id="tipoMovimento" required onchange="mostrarCamposDinamicos()">
                  <option value="">-- Selecione --</option>
                  <option value="entrada">üì• Entrada</option>
                  <option value="saida">üì§ Sa√≠da</option>
                </select>
              </div>
              <div class="form-group">
                <label>Quantidade *</label>
                <input type="number" id="qtdMovimento" required min="1" placeholder="0">
              </div>
            </div>

            <!-- Campos para SA√çDA -->
            <div id="camposSaida" style="display: none;">
              <div class="form-row">
                <div class="form-group">
                  <label>Requisitante *</label>
                  <input type="text" id="requisiante" placeholder="Nome de quem requisitou">
                </div>
                <div class="form-group">
                  <label>Local de Aplica√ß√£o *</label>
                  <input type="text" id="localAplicacao" placeholder="Onde ser√° utilizado">
                </div>
              </div>
              <div class="form-row">
                <div class="form-group">
                  <label>Motivo/Observa√ß√£o</label>
                  <input type="text" id="motivoMovimento" placeholder="Ex: Requisi√ß√£o, Devolu√ß√£o, etc">
                </div>
              </div>
            </div>

            <!-- Campos para ENTRADA -->
            <div id="camposEntrada" style="display: none;">
              <div class="form-row">
                <div class="form-group">
                  <label>Pre√ßo Unit√°rio (Opcional)</label>
                  <input type="number" id="precoUnitario" placeholder="0.00" step="0.01" min="0">
                </div>
                <div class="form-group">
                  <label>N¬∫ NF (Opcional)</label>
                  <input type="text" id="numeroNF" placeholder="Ex: 123456">
                </div>
                <div class="form-group">
                  <label>Fornecedor (Opcional)</label>
                  <input type="text" id="fornecedor" placeholder="Nome do fornecedor">
                </div>
              </div>
            </div>
            <button type="submit" class="btn btn-primary">‚úÖ Registrar Movimenta√ß√£o</button>
          </form>
        </div>

        <!-- Hist√≥rico de Movimentos -->
        <div class="table-section">
          <h3>Hist√≥rico de Movimenta√ß√µes</h3>
          <table id="tabelaMovimentos">
            <thead>
              <tr>
                <th>Data</th>
                <th>Produto</th>
                <th>SKU</th>
                <th>Tipo</th>
                <th>Quantidade</th>
                <th>Detalhes</th>
                <th>Operador</th>
                <th>A√ß√µes</th>
              </tr>
            </thead>
            <tbody id="bodyMovimentos">
              <tr>
                <td colspan="8" style="text-align: center;">Nenhuma movimenta√ß√£o registrada</td>
              </tr>
            </tbody>
          </table>
        </div>
      </section>

      <!-- Se√ß√£o de Relat√≥rios -->
      <section id="relatorios" class="section">
        <h2>Relat√≥rios</h2>

        <!-- Estoque Baixo -->
        <div class="report-section">
          <h3>‚ö†Ô∏è Produtos com Estoque Baixo</h3>
          <div class="form-row">
            <div class="form-group">
              <label>Limite de Estoque</label>
              <input type="number" id="limiteEstoque" value="10" min="1">
            </div>
            <button class="btn btn-secondary" onclick="carregarEstoqueBaixo()">üîÑ Atualizar</button>
          </div>
          <table id="tabelaEstoqueBaixo">
            <thead>
              <tr>
                <th>Nome</th>
                <th>SKU</th>
                <th>Quantidade</th>
                <th>Pre√ßo</th>
                <th>Categoria</th>
              </tr>
            </thead>
            <tbody id="bodyEstoqueBaixo">
              <tr>
                <td colspan="5" style="text-align: center;">Carregando...</td>
              </tr>
            </tbody>
          </table>
        </div>

        <!-- Resumo de Estoque -->
        <div class="report-section">
          <h3>üìä Resumo de Estoque</h3>
          <div class="stats">
            <div class="stat-card">
              <h4>Total de Produtos</h4>
              <p id="totalProdutos">0</p>
            </div>
            <div class="stat-card">
              <h4>Valor Total em Estoque</h4>
              <p id="valorTotal">R$ 0,00</p>
            </div>
            <div class="stat-card">
              <h4>Produtos em Falta</h4>
              <p id="produtosEmFalta">0</p>
            </div>
          </div>
        </div>
      </section>
    </main>
  </div>

  <!-- Modal de Edi√ß√£o -->
  <div id="modalEditar" class="modal">
    <div class="modal-content">
      <span class="close">&times;</span>
      <h2>Editar Produto</h2>
      <form id="formEditarProduto">
        <input type="hidden" id="idProdutoEdicao">
        <div class="form-row">
          <div class="form-group">
            <label>Nome *</label>
            <input type="text" id="nomeEditar" required>
          </div>
          <div class="form-group">
            <label>SKU *</label>
            <input type="text" id="skuEditar" required>
          </div>
        </div>
        <div class="form-row">
          <div class="form-group">
            <label>Quantidade *</label>
            <input type="number" id="qtdEditar" required min="0">
          </div>
          <div class="form-group">
            <label>Pre√ßo</label>
            <input type="number" id="precoEditar" step="0.01">
          </div>
        <div class="form-row">
          <div class="form-group">
            <label>Categoria</label>
            <input type="text" id="categoriaEditar">
          </div>
          <div class="form-group">
            <label>Fam√≠lia (Grupo)</label>
            <input type="text" id="grupoEditar">
          </div>
        </div>
        <div style="margin-bottom: 15px;">
          <strong>Atributos</strong>
          <div id="listaAtributosEditar" style="margin-top: 10px;"></div>
          <button type="button" class="btn btn-small btn-secondary" onclick="adicionarCampoAtributoEditar()" title="Adicionar atributo">‚ûï Adicionar Atributo</button>
        </div>
        <button type="submit" class="btn btn-primary">üíæ Salvar Altera√ß√µes</button>
      </form>
    </div>
  </div>
 <div id="modalMovimentacao" class="modal">
  <div class="modal-content">
    <span class="close" onclick="document.getElementById('modalMovimentacao').classList.remove('show')">&times;</span>
    <h2>Editar Movimenta√ß√£o</h2>
    
    <form id="formEditarMovimento">
      <div class="form-group">
        <label>Data</label>
        <input type="text" id="movData" readonly disabled style="background: #eee;">
      </div>

      <div class="form-group">
        <label>Produto</label>
        <input type="text" id="movNome" readonly disabled style="background: #eee;">
      </div>

      <div class="form-group">
        <label>Operador</label>
        <input type="text" id="movOperador" readonly disabled style="background: #eee;">
      </div>

      <div class="form-group">
        <label>Tipo</label>
        <select id="movTipo" onchange="mostrarCamposDinamicosModal()">
            <option value="entrada">Entrada</option>
            <option value="saida">Sa√≠da</option>
        </select>
      </div>

      <div class="form-group">
        <label>Quantidade</label>
        <input type="number" id="movQtd" required>
      </div>

      <!-- Campos para SA√çDA no modal -->
      <div id="camposSaidaModal" style="display: none;">
        <div class="form-group">
          <label>Requisitante</label>
          <input type="text" id="movRequisitante">
        </div>
        <div class="form-group">
          <label>Local de Aplica√ß√£o</label>
          <input type="text" id="movLocalAplicacao">
        </div>
        <div class="form-group">
          <label>Motivo/Observa√ß√£o</label>
          <input type="text" id="movMotivo">
        </div>
      </div>

      <!-- Campos para ENTRADA no modal -->
      <div id="camposEntradaModal" style="display: none;">
        <div class="form-group">
          <label>Pre√ßo Unit√°rio</label>
          <input type="number" id="movPrecoUnitario" step="0.01" min="0">
        </div>
        <div class="form-group">
          <label>N¬∫ NF</label>
          <input type="text" id="movNumeroNF">
        </div>
        <div class="form-group">
          <label>Fornecedor</label>
          <input type="text" id="movFornecedor">
        </div>
      </div>

      <div style="margin-top: 15px;">
          <button type="submit" class="btn btn-primary">Salvar</button>
          <button type="button" class="btn btn-danger" onclick="document.getElementById('modalMovimentacao').classList.remove('show')">Cancelar</button>
      </div>
    </form>
  </div>
</div>
  <script src="script.js"></script>
</body>
</html>
